# 企業情報自動収集システム要件定義書

## 文書情報
- 作成日：2025年6月1日
- バージョン：1.0
- 作成者：システム要件定義支援AI

## 1. プロジェクト概要

### 1.1 システム名称
企業情報自動収集システム（Corporate Info Collector）

### 1.2 目的
営業代行における顧客リスト作成業務の効率化。手作業による企業情報収集時間を週66-100時間から大幅短縮する。

### 1.3 背景と課題
- 現在：1社あたり20分の手作業による情報収集（企業HPを中心とした調査）
- 週次で200-300社の処理が必要
- 営業代行として様々なクライアントの商材に対応するため、汎用的な企業セグメント情報が必要
- 手作業による時間コストの削減が急務

### 1.4 プロジェクトのゴール
- 企業情報収集作業の自動化により、週次作業時間を90%以上削減
- 汎用的で一貫性のある企業データの取得
- ダッシュボード分析に適した構造化データの生成

## 2. ステークホルダー

### 2.1 利用者（ユーザー）
営業代行会社のリスト作成担当者（単一ユーザー想定）

### 2.2 システム管理者
技術担当者（システム運用・保守）

### 2.3 その他関係者
営業代行のクライアント（間接的にシステムの恩恵を受ける）

## 3. システム要件

### 3.1 機能要件

#### 3.1.1 データ処理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------| 
| F-001 | バッチ処理実行 | スプレッドシートから企業名・電話番号を読み取り、一括処理 | 高 |
| F-002 | 企業情報検索 | Tavily APIを使用した企業情報の検索・取得 | 高 |
| F-003 | LLM情報構造化 | GPT-4o-miniで検索結果を構造化し、統一フォーマットに変換 | 高 |
| F-004 | 結果出力 | 構造化データをスプレッドシートに出力 | 高 |

#### 3.1.2 データ品質管理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-005 | 重複企業検出 | 企業名・電話番号による重複チェック機能 | 高 |
| F-006 | データ品質チェック | 情報の信頼性・完整性を評価 | 高 |
| F-007 | エラーハンドリング | 取得失敗企業の識別・ログ出力 | 高 |

#### 3.1.3 運用管理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-008 | 処理履歴管理 | バッチ処理の実行履歴・ログ管理 | 中 |

### 3.2 非機能要件

#### 3.2.1 性能要件
| 要件ID | 要件名 | 説明 | 指標 |
|--------|--------|------|------|
| NF-001 | 処理時間 | 1社あたりの処理時間 | 平均30秒以内 |
| NF-002 | バッチ処理性能 | 300社の一括処理時間 | 2時間以内で完了 |

#### 3.2.2 セキュリティ要件
| 要件ID | 要件名 | 説明 |
|--------|--------|------|
| NF-003 | API認証管理 | Google Cloud IAM、Tavily APIキーの適切な管理 |
| NF-004 | データ保護 | 収集した企業データの適切な取り扱いと保護 |

#### 3.2.3 可用性要件
| 要件ID | 要件名 | 説明 |
|--------|--------|------|
| NF-005 | エラー回復 | API制限やネットワークエラー時の自動リトライ機能 |
| NF-006 | 部分失敗対応 | 一部企業の処理失敗が全体処理に影響しない設計 |

#### 3.2.4 保守性要件
| 要件ID | 要件名 | 説明 |
|--------|--------|------|
| NF-007 | ログ管理 | 処理状況、エラー内容の詳細ログ取得 |
| NF-008 | 監視機能 | 処理状況の可視化とアラート機能 |

## 4. システム構成

### 4.1 技術スタック
- **実行基盤**: Google Cloud Functions（サーバーレス）
- **プログラミング言語**: Python
- **ワークフロー管理**: LangChain
- **LLM**: GPT-4o-mini
- **検索API**: Tavily API
- **データ入出力**: Google Sheets API
- **ストレージ**: Google Cloud Storage（ログ・一時ファイル）

### 4.2 ワークフロー構成
**Phase 1: 企業特定フェーズ**
- Tavily APIによる企業検索（企業名 + 電話番号）
- GPT-4o-miniによる正しい企業の特定・検証
- 信頼性スコアの算出

**Phase 2: 情報抽出フェーズ**
- 企業詳細情報の検索・取得
- GPT-4o-miniによる非構造化データの構造化
- データ検証・補完処理

**Phase 3: 出力フェーズ**
- 重複チェック・名寄せ処理
- データ品質チェック
- Google Sheets APIへの結果出力

### 4.3 データ項目

**基本企業情報**
- 企業名（正式名称）
- 業種（日本標準産業分類：大分類・中分類）
- 従業員数
- 設立年
- 資本金
- 上場区分（上場/非上場、市場区分）

**所在地・組織情報**
- 本社所在地（都道府県、市区町村）
- 支社・営業所の有無

**経営陣情報**
- 代表者名・役職
- 代表者年齢（取得可能な場合）

**事業活動情報**
- 企業理念・事業方針
- 最新ニュース・プレスリリース（直近1年）
- 採用活動状況
- 新商品・サービス展開状況

**データ品質管理項目**
- 情報取得日時
- データ取得成功/失敗フラグ
- 信頼性スコア（0.0-1.0）
- 情報ソースURL

## 5. 制約条件

### 5.1 技術的制約
- Google Cloud Functions：最大実行時間9分の制限
- Tavily API：レート制限への対応が必要
- GPT-4o-mini API：コスト・レスポンス時間の最適化が必要

### 5.2 予算的制約
- LLM API使用料金の最適化
- Cloud Functions実行コストの最小化

### 5.3 時間的制約
- 週次バッチ処理での運用
- 1回の処理は2時間以内での完了

## 6. 前提条件
- 企業名と電話番号を含むスプレッドシートが事前に準備されている
- Google Cloud Platform環境が利用可能
- Tavily API、OpenAI APIのアカウント・APIキーが取得済み
- 処理対象は日本国内の企業を想定

## 7. リスク

| リスクID | リスク内容 | 影響度 | 対応策 |
|----------|------------|--------|--------|
| R-001 | Tavily API制限到達 | 高 | レート制限監視、処理間隔調整、代替検索手段の検討 |
| R-002 | GPT-4o-miniの抽出精度不足 | 中 | プロンプトエンジニアリング、人手による品質チェック |
| R-003 | 企業HPの構造変化 | 中 | 柔軟な抽出ロジック、複数ソースからの情報取得 |
| R-004 | Cloud Functions実行時間制限 | 高 | 処理の適切な分割、並列実行制御 |
| R-005 | 法的・倫理的問題 | 中 | スクレイピング対象サイトの利用規約確認、適切なアクセス頻度の設定 |

## 8. 将来的な拡張性
- 収集データ項目の追加・カスタマイズ機能
- 他の検索APIとの連携（企業データベースAPI等）
- リアルタイム処理モードの追加
- ダッシュボード機能の直接統合
- 多言語対応（海外企業情報の収集）

## 9. 用語集

| 用語 | 説明 |
|------|------|
| Tavily API | Web検索に特化したAPIサービス、企業情報の検索に使用 |
| LangChain | LLMアプリケーション開発のためのフレームワーク |
| GPT-4o-mini | OpenAIの小型高性能言語モデル |
| バッチ処理 | 一定量のデータをまとめて一括で処理する方式 |
| スクレイピング | Webサイトから情報を自動抽出する技術 |
| 名寄せ | 同一企業の表記ゆれを統一する処理 |

## 10. 承認

| 役割 | 氏名 | 日付 | 署名 |
|------|------|------|------|
| プロジェクト責任者 | 【要記入】 | 【要記入】 | 【要記入】 |
| 技術責任者 | 【要記入】 | 【要記入】 | 【要記入】 |
| ユーザー代表 | 【要記入】 | 【要記入】 | 【要記入】 |