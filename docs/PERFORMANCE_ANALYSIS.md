# 企業情報収集システム 性能分析レポート

## 実行時間制限と処理能力

### Google Apps Script制限
- **実行時間制限**: 6分（360秒）/実行
- **メモリ制限**: 100MB
- **外部API呼び出し制限**: 20,000回/日

### 実測処理時間（v1.2）
- **1社あたり平均処理時間**: 約40秒
- **内訳**:
  - 検索API呼び出し: 8-12秒
  - OpenAI情報抽出: 15-20秒
  - ニュース・採用情報取得: 10-15秒
  - データ処理・保存: 2-3秒

### 現実的なバッチサイズ
- **推奨バッチサイズ**: 8社
- **計算根拠**: 40秒 × 8社 = 320秒（6分制限内）
- **安全マージン**: 40秒（予期しない遅延対応）

## 大量処理のスケジュール例

### 100社処理の場合
- **必要バッチ数**: 13バッチ（100社 ÷ 8社）
- **総処理時間**: 約8時間30分
- **推奨スケジュール**: 
  - 1日目: 5バッチ（40社）
  - 2日目: 5バッチ（40社）
  - 3日目: 3バッチ（20社）

### 200社処理の場合
- **必要バッチ数**: 25バッチ（200社 ÷ 8社）
- **総処理時間**: 約16時間40分
- **推奨スケジュール**: 週5日間で分散処理

## コスト分析

### API使用料（1社あたり）
- **Tavily API**: 約3円/社
- **OpenAI API**: 約0.15円/社
- **合計**: 約3.15円/社

### 月間処理コスト例
- **50社/月**: 約158円
- **100社/月**: 約315円
- **200社/月**: 約630円

## 改善提案

### 短期改善（現在の制約内）
1. **並列処理の最適化**
   - 検索とニュース取得の並列実行
   - 目標: 1社あたり30秒に短縮

2. **キャッシュ機能の追加**
   - 重複企業の検索結果をキャッシュ
   - 目標: 再処理時間50%削減

### 長期改善（アーキテクチャ変更）
1. **Cloud Functions移行**
   - 実行時間制限の撤廃
   - 目標: 1バッチ50社処理

2. **分散処理システム**
   - 複数のワーカーで並列処理
   - 目標: 200社を2時間で処理

## 運用推奨事項

### 日常運用
- **1回の処理**: 8社以下
- **処理頻度**: 1日3-4回まで
- **監視項目**: 処理時間、エラー率、API使用量

### 大量処理時
- **事前計画**: 処理スケジュールの作成
- **分散実行**: 複数日に分けて実行
- **監視強化**: リアルタイムでの進捗確認

### エラー対応
- **自動リトライ**: 3回まで
- **手動再実行**: エラー企業のみ個別処理
- **ログ確認**: 詳細なエラー情報の記録 